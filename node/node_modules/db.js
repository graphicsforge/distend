
var System = require('cassandra-client').System;
var sys = new System('localhost:9160');
var uuid = new require('uuid-js');

var PooledConnection = require('cassandra-client').PooledConnection;
var hosts = ['localhost:9160'];
var connection_pool = new PooledConnection({'hosts': hosts, 'keyspace': 'distend'});

// initialize user table if we don't have one yet
connection_pool.execute('CREATE TABLE users ('+
  'username text PRIMARY KEY,'+
  'img text,'+
  'firstName text,'+
  'lastName text)'
  , [], function(err) {
    if ( err ) { return; }
    console.log('created user table');
  }
});

function FBSignIn( username, img, firstName, lastName, callback )
{
  connection_pool.execute('UPDATE users SET img=?, firstName=?, lastName=? WHERE username=?',
    [img, firstName, lastName, username],
    function(err) {
      if ( err ) { console.log(err); return; }
    });
  });
}

